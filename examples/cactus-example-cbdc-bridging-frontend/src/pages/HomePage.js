import React, { useState, useEffect } from "react";
import makeStyles from "@mui/styles/makeStyles";

import Grid from "@mui/material/Grid";
import Ledger from "../components/Ledger";
import {
  checkApiServer1Connection,
  checkApiServer2Connection,
} from "../api-calls/common";
import ConnectionErrorDialog from "../components/dialogs/ConnectionErrorDialog";

const useStyles = makeStyles((theme) => ({
  container: {
    width: "95%",
    margin: "2rem auto",
  },
  paper: {
    backgroundColor: "#e1f3fa",
    margin: "auto",
    padding: "2rem",
  },
  imgBridgeHorizontal: {
    marginTop: "15rem",
    [theme.breakpoints.down("md")]: {
      display: "none",
    },
  },
  imgBridgeVertical: {
    margin: "2rem auto",
    [theme.breakpoints.up("md")]: {
      display: "none",
    },
  },
}));

export default function HomePage() {
  const classes = useStyles();
  const [errorDialog, setErrorDialog] = useState(false);

  useEffect(() => {
    async function checkConnection() {
      await checkApiServer1Connection()
        .then(() => setErrorDialog(false))
        .catch(() => setErrorDialog(true));

      await checkApiServer2Connection()
        .then(() => setErrorDialog(false))
        .catch(() => setErrorDialog(true));
    }

    checkConnection();
  }, []);

  return (
    <div className={classes.container}>
      <Grid container>
        <Grid item sm={12} md={5}>
          <Ledger ledger={"Fabric"} />
        </Grid>
        <Grid item sm={12} md={2}>
          <BridgeImage />
        </Grid>
        <Grid item sm={12} md={5}>
          <Ledger ledger={"Besu"} />
        </Grid>
      </Grid>
      <ConnectionErrorDialog
        open={errorDialog}
        onClose={() => setErrorDialog(false)}
      />
    </div>
  );
}

function BridgeImage() {
  const classes = useStyles();

  return (
    <div>
      <svg
        width="105"
        height="203"
        viewBox="0 0 105 203"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className={classes.imgBridgeHorizontal}
      >
        <path
          d="M91.4749 28.4749C92.8417 27.108 92.8417 24.892 91.4749 23.5251L69.201 1.25126C67.8342 -0.115572 65.6181 -0.115572 64.2513 1.25126C62.8844 2.6181 62.8844 4.83418 64.2513 6.20101L84.0503 26L64.2513 45.799C62.8844 47.1658 62.8844 49.3819 64.2513 50.7487C65.6181 52.1156 67.8342 52.1156 69.201 50.7487L91.4749 28.4749ZM16 29.5H89V22.5H16V29.5Z"
          fill="#CECECE"
        />
        <path
          d="M13.5251 174.525C12.1583 175.892 12.1583 178.108 13.5251 179.475L35.799 201.749C37.1658 203.116 39.3819 203.116 40.7487 201.749C42.1156 200.382 42.1156 198.166 40.7487 196.799L20.9497 177L40.7487 157.201C42.1156 155.834 42.1156 153.618 40.7487 152.251C39.3819 150.884 37.1658 150.884 35.799 152.251L13.5251 174.525ZM16 180.5H89V173.5H16V180.5Z"
          fill="#CECECE"
        />
        <path
          d="M19.7367 109V95H26.0167C27.6301 95 28.8701 95.3267 29.7367 95.98C30.6034 96.62 31.0367 97.5 31.0367 98.62C31.0367 99.38 30.8634 100.02 30.5167 100.54C30.1834 101.06 29.7301 101.46 29.1567 101.74C28.5834 102.02 27.9634 102.16 27.2967 102.16L27.6567 101.56C28.4567 101.56 29.1634 101.7 29.7767 101.98C30.3901 102.26 30.8767 102.673 31.2367 103.22C31.5967 103.753 31.7767 104.42 31.7767 105.22C31.7767 106.42 31.3234 107.353 30.4167 108.02C29.5234 108.673 28.1901 109 26.4167 109H19.7367ZM21.7367 107.38H26.3367C27.4434 107.38 28.2901 107.193 28.8767 106.82C29.4634 106.447 29.7567 105.86 29.7567 105.06C29.7567 104.247 29.4634 103.653 28.8767 103.28C28.2901 102.907 27.4434 102.72 26.3367 102.72H21.5567V101.1H25.8367C26.8501 101.1 27.6367 100.913 28.1967 100.54C28.7567 100.167 29.0367 99.6067 29.0367 98.86C29.0367 98.1133 28.7567 97.5533 28.1967 97.18C27.6367 96.8067 26.8501 96.62 25.8367 96.62H21.7367V107.38ZM34.8434 109V98.4H36.6834V101.28L36.5034 100.56C36.7968 99.8267 37.2901 99.2667 37.9834 98.88C38.6768 98.4933 39.5301 98.3 40.5434 98.3V100.16C40.4634 100.147 40.3834 100.14 40.3034 100.14C40.2368 100.14 40.1701 100.14 40.1034 100.14C39.0768 100.14 38.2634 100.447 37.6634 101.06C37.0634 101.673 36.7634 102.56 36.7634 103.72V109H34.8434ZM43.1598 109V98.4H45.0798V109H43.1598ZM44.1198 96.36C43.7465 96.36 43.4332 96.24 43.1798 96C42.9398 95.76 42.8198 95.4667 42.8198 95.12C42.8198 94.76 42.9398 94.46 43.1798 94.22C43.4332 93.98 43.7465 93.86 44.1198 93.86C44.4932 93.86 44.7998 93.98 45.0398 94.22C45.2932 94.4467 45.4198 94.7333 45.4198 95.08C45.4198 95.44 45.2998 95.7467 45.0598 96C44.8198 96.24 44.5065 96.36 44.1198 96.36ZM53.3758 109.12C52.3491 109.12 51.4291 108.893 50.6158 108.44C49.8158 107.987 49.1824 107.353 48.7158 106.54C48.2491 105.727 48.0158 104.78 48.0158 103.7C48.0158 102.62 48.2491 101.68 48.7158 100.88C49.1824 100.067 49.8158 99.4333 50.6158 98.98C51.4291 98.5267 52.3491 98.3 53.3758 98.3C54.2691 98.3 55.0758 98.5 55.7958 98.9C56.5158 99.3 57.0891 99.9 57.5158 100.7C57.9558 101.5 58.1758 102.5 58.1758 103.7C58.1758 104.9 57.9624 105.9 57.5358 106.7C57.1224 107.5 56.5558 108.107 55.8358 108.52C55.1158 108.92 54.2958 109.12 53.3758 109.12ZM53.5358 107.44C54.2024 107.44 54.8024 107.287 55.3358 106.98C55.8824 106.673 56.3091 106.24 56.6158 105.68C56.9358 105.107 57.0958 104.447 57.0958 103.7C57.0958 102.94 56.9358 102.287 56.6158 101.74C56.3091 101.18 55.8824 100.747 55.3358 100.44C54.8024 100.133 54.2024 99.98 53.5358 99.98C52.8558 99.98 52.2491 100.133 51.7158 100.44C51.1824 100.747 50.7558 101.18 50.4358 101.74C50.1158 102.287 49.9558 102.94 49.9558 103.7C49.9558 104.447 50.1158 105.107 50.4358 105.68C50.7558 106.24 51.1824 106.673 51.7158 106.98C52.2491 107.287 52.8558 107.44 53.5358 107.44ZM57.1558 109V106.14L57.2758 103.68L57.0758 101.22V94.16H58.9958V109H57.1558ZM67.5186 113C66.5453 113 65.5986 112.86 64.6786 112.58C63.7719 112.313 63.0319 111.927 62.4586 111.42L63.3786 109.94C63.8719 110.367 64.4786 110.7 65.1986 110.94C65.9186 111.193 66.6719 111.32 67.4586 111.32C68.7119 111.32 69.6319 111.027 70.2186 110.44C70.8053 109.853 71.0986 108.96 71.0986 107.76V105.52L71.2986 103.42L71.1986 101.3V98.4H73.0186V107.56C73.0186 109.427 72.5519 110.8 71.6186 111.68C70.6853 112.56 69.3186 113 67.5186 113ZM67.2786 108.56C66.2519 108.56 65.3319 108.347 64.5186 107.92C63.7186 107.48 63.0786 106.873 62.5986 106.1C62.1319 105.327 61.8986 104.433 61.8986 103.42C61.8986 102.393 62.1319 101.5 62.5986 100.74C63.0786 99.9667 63.7186 99.3667 64.5186 98.94C65.3319 98.5133 66.2519 98.3 67.2786 98.3C68.1853 98.3 69.0119 98.4867 69.7586 98.86C70.5053 99.22 71.0986 99.78 71.5386 100.54C71.9919 101.3 72.2186 102.26 72.2186 103.42C72.2186 104.567 71.9919 105.52 71.5386 106.28C71.0986 107.04 70.5053 107.613 69.7586 108C69.0119 108.373 68.1853 108.56 67.2786 108.56ZM67.4986 106.88C68.2053 106.88 68.8319 106.733 69.3786 106.44C69.9253 106.147 70.3519 105.74 70.6586 105.22C70.9786 104.7 71.1386 104.1 71.1386 103.42C71.1386 102.74 70.9786 102.14 70.6586 101.62C70.3519 101.1 69.9253 100.7 69.3786 100.42C68.8319 100.127 68.2053 99.98 67.4986 99.98C66.7919 99.98 66.1586 100.127 65.5986 100.42C65.0519 100.7 64.6186 101.1 64.2986 101.62C63.9919 102.14 63.8386 102.74 63.8386 103.42C63.8386 104.1 63.9919 104.7 64.2986 105.22C64.6186 105.74 65.0519 106.147 65.5986 106.44C66.1586 106.733 66.7919 106.88 67.4986 106.88ZM81.6572 109.12C80.5239 109.12 79.5239 108.887 78.6572 108.42C77.8039 107.953 77.1372 107.313 76.6572 106.5C76.1905 105.687 75.9572 104.753 75.9572 103.7C75.9572 102.647 76.1839 101.713 76.6372 100.9C77.1039 100.087 77.7372 99.4533 78.5372 99C79.3505 98.5333 80.2639 98.3 81.2772 98.3C82.3039 98.3 83.2105 98.5267 83.9972 98.98C84.7839 99.4333 85.3972 100.073 85.8372 100.9C86.2905 101.713 86.5172 102.667 86.5172 103.76C86.5172 103.84 86.5105 103.933 86.4972 104.04C86.4972 104.147 86.4905 104.247 86.4772 104.34H77.4572V102.96H85.4772L84.6972 103.44C84.7105 102.76 84.5705 102.153 84.2772 101.62C83.9839 101.087 83.5772 100.673 83.0572 100.38C82.5505 100.073 81.9572 99.92 81.2772 99.92C80.6105 99.92 80.0172 100.073 79.4972 100.38C78.9772 100.673 78.5705 101.093 78.2772 101.64C77.9839 102.173 77.8372 102.787 77.8372 103.48V103.8C77.8372 104.507 77.9972 105.14 78.3172 105.7C78.6505 106.247 79.1105 106.673 79.6972 106.98C80.2839 107.287 80.9572 107.44 81.7172 107.44C82.3439 107.44 82.9105 107.333 83.4172 107.12C83.9372 106.907 84.3905 106.587 84.7772 106.16L85.8372 107.4C85.3572 107.96 84.7572 108.387 84.0372 108.68C83.3305 108.973 82.5372 109.12 81.6572 109.12Z"
          fill="#A3A3A3"
        />
      </svg>
      <svg
        width="247"
        height="81"
        viewBox="0 0 247 81"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className={classes.imgBridgeVertical}
      >
        <path
          d="M28.4749 1.52513C27.108 0.158291 24.892 0.158291 23.5251 1.52513L1.25126 23.799C-0.115572 25.1658 -0.115572 27.3819 1.25126 28.7487C2.6181 30.1156 4.83418 30.1156 6.20101 28.7487L26 8.94975L45.799 28.7487C47.1658 30.1156 49.3819 30.1156 50.7487 28.7487C52.1156 27.3819 52.1156 25.1658 50.7487 23.799L28.4749 1.52513ZM29.5 77L29.5 4H22.5L22.5 77H29.5Z"
          fill="#CECECE"
        />
        <path
          d="M218.525 79.4749C219.892 80.8417 222.108 80.8417 223.475 79.4749L245.749 57.201C247.116 55.8342 247.116 53.6181 245.749 52.2513C244.382 50.8844 242.166 50.8844 240.799 52.2513L221 72.0503L201.201 52.2513C199.834 50.8844 197.618 50.8844 196.251 52.2513C194.884 53.6181 194.884 55.8342 196.251 57.201L218.525 79.4749ZM224.5 77V4H217.5V77H224.5Z"
          fill="#CECECE"
        />
        <path
          d="M90.7367 48V34H97.0167C98.6301 34 99.8701 34.3267 100.737 34.98C101.603 35.62 102.037 36.5 102.037 37.62C102.037 38.38 101.863 39.02 101.517 39.54C101.183 40.06 100.73 40.46 100.157 40.74C99.5834 41.02 98.9634 41.16 98.2967 41.16L98.6567 40.56C99.4567 40.56 100.163 40.7 100.777 40.98C101.39 41.26 101.877 41.6733 102.237 42.22C102.597 42.7533 102.777 43.42 102.777 44.22C102.777 45.42 102.323 46.3533 101.417 47.02C100.523 47.6733 99.1901 48 97.4167 48H90.7367ZM92.7367 46.38H97.3367C98.4434 46.38 99.2901 46.1933 99.8767 45.82C100.463 45.4467 100.757 44.86 100.757 44.06C100.757 43.2467 100.463 42.6533 99.8767 42.28C99.2901 41.9067 98.4434 41.72 97.3367 41.72H92.5567V40.1H96.8367C97.8501 40.1 98.6367 39.9133 99.1967 39.54C99.7567 39.1667 100.037 38.6067 100.037 37.86C100.037 37.1133 99.7567 36.5533 99.1967 36.18C98.6367 35.8067 97.8501 35.62 96.8367 35.62H92.7367V46.38ZM105.843 48V37.4H107.683V40.28L107.503 39.56C107.797 38.8267 108.29 38.2667 108.983 37.88C109.677 37.4933 110.53 37.3 111.543 37.3V39.16C111.463 39.1467 111.383 39.14 111.303 39.14C111.237 39.14 111.17 39.14 111.103 39.14C110.077 39.14 109.263 39.4467 108.663 40.06C108.063 40.6733 107.763 41.56 107.763 42.72V48H105.843ZM114.16 48V37.4H116.08V48H114.16ZM115.12 35.36C114.747 35.36 114.433 35.24 114.18 35C113.94 34.76 113.82 34.4667 113.82 34.12C113.82 33.76 113.94 33.46 114.18 33.22C114.433 32.98 114.747 32.86 115.12 32.86C115.493 32.86 115.8 32.98 116.04 33.22C116.293 33.4467 116.42 33.7333 116.42 34.08C116.42 34.44 116.3 34.7467 116.06 35C115.82 35.24 115.507 35.36 115.12 35.36ZM124.376 48.12C123.349 48.12 122.429 47.8933 121.616 47.44C120.816 46.9867 120.182 46.3533 119.716 45.54C119.249 44.7267 119.016 43.78 119.016 42.7C119.016 41.62 119.249 40.68 119.716 39.88C120.182 39.0667 120.816 38.4333 121.616 37.98C122.429 37.5267 123.349 37.3 124.376 37.3C125.269 37.3 126.076 37.5 126.796 37.9C127.516 38.3 128.089 38.9 128.516 39.7C128.956 40.5 129.176 41.5 129.176 42.7C129.176 43.9 128.962 44.9 128.536 45.7C128.122 46.5 127.556 47.1067 126.836 47.52C126.116 47.92 125.296 48.12 124.376 48.12ZM124.536 46.44C125.202 46.44 125.802 46.2867 126.336 45.98C126.882 45.6733 127.309 45.24 127.616 44.68C127.936 44.1067 128.096 43.4467 128.096 42.7C128.096 41.94 127.936 41.2867 127.616 40.74C127.309 40.18 126.882 39.7467 126.336 39.44C125.802 39.1333 125.202 38.98 124.536 38.98C123.856 38.98 123.249 39.1333 122.716 39.44C122.182 39.7467 121.756 40.18 121.436 40.74C121.116 41.2867 120.956 41.94 120.956 42.7C120.956 43.4467 121.116 44.1067 121.436 44.68C121.756 45.24 122.182 45.6733 122.716 45.98C123.249 46.2867 123.856 46.44 124.536 46.44ZM128.156 48V45.14L128.276 42.68L128.076 40.22V33.16H129.996V48H128.156ZM138.519 52C137.545 52 136.599 51.86 135.679 51.58C134.772 51.3133 134.032 50.9267 133.459 50.42L134.379 48.94C134.872 49.3667 135.479 49.7 136.199 49.94C136.919 50.1933 137.672 50.32 138.459 50.32C139.712 50.32 140.632 50.0267 141.219 49.44C141.805 48.8533 142.099 47.96 142.099 46.76V44.52L142.299 42.42L142.199 40.3V37.4H144.019V46.56C144.019 48.4267 143.552 49.8 142.619 50.68C141.685 51.56 140.319 52 138.519 52ZM138.279 47.56C137.252 47.56 136.332 47.3467 135.519 46.92C134.719 46.48 134.079 45.8733 133.599 45.1C133.132 44.3267 132.899 43.4333 132.899 42.42C132.899 41.3933 133.132 40.5 133.599 39.74C134.079 38.9667 134.719 38.3667 135.519 37.94C136.332 37.5133 137.252 37.3 138.279 37.3C139.185 37.3 140.012 37.4867 140.759 37.86C141.505 38.22 142.099 38.78 142.539 39.54C142.992 40.3 143.219 41.26 143.219 42.42C143.219 43.5667 142.992 44.52 142.539 45.28C142.099 46.04 141.505 46.6133 140.759 47C140.012 47.3733 139.185 47.56 138.279 47.56ZM138.499 45.88C139.205 45.88 139.832 45.7333 140.379 45.44C140.925 45.1467 141.352 44.74 141.659 44.22C141.979 43.7 142.139 43.1 142.139 42.42C142.139 41.74 141.979 41.14 141.659 40.62C141.352 40.1 140.925 39.7 140.379 39.42C139.832 39.1267 139.205 38.98 138.499 38.98C137.792 38.98 137.159 39.1267 136.599 39.42C136.052 39.7 135.619 40.1 135.299 40.62C134.992 41.14 134.839 41.74 134.839 42.42C134.839 43.1 134.992 43.7 135.299 44.22C135.619 44.74 136.052 45.1467 136.599 45.44C137.159 45.7333 137.792 45.88 138.499 45.88ZM152.657 48.12C151.524 48.12 150.524 47.8867 149.657 47.42C148.804 46.9533 148.137 46.3133 147.657 45.5C147.191 44.6867 146.957 43.7533 146.957 42.7C146.957 41.6467 147.184 40.7133 147.637 39.9C148.104 39.0867 148.737 38.4533 149.537 38C150.351 37.5333 151.264 37.3 152.277 37.3C153.304 37.3 154.211 37.5267 154.997 37.98C155.784 38.4333 156.397 39.0733 156.837 39.9C157.291 40.7133 157.517 41.6667 157.517 42.76C157.517 42.84 157.511 42.9333 157.497 43.04C157.497 43.1467 157.491 43.2467 157.477 43.34H148.457V41.96H156.477L155.697 42.44C155.711 41.76 155.571 41.1533 155.277 40.62C154.984 40.0867 154.577 39.6733 154.057 39.38C153.551 39.0733 152.957 38.92 152.277 38.92C151.611 38.92 151.017 39.0733 150.497 39.38C149.977 39.6733 149.571 40.0933 149.277 40.64C148.984 41.1733 148.837 41.7867 148.837 42.48V42.8C148.837 43.5067 148.997 44.14 149.317 44.7C149.651 45.2467 150.111 45.6733 150.697 45.98C151.284 46.2867 151.957 46.44 152.717 46.44C153.344 46.44 153.911 46.3333 154.417 46.12C154.937 45.9067 155.391 45.5867 155.777 45.16L156.837 46.4C156.357 46.96 155.757 47.3867 155.037 47.68C154.331 47.9733 153.537 48.12 152.657 48.12Z"
          fill="#A3A3A3"
        />
      </svg>
    </div>
  );
}
